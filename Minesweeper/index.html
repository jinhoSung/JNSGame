<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dungeon Sweeper RPG</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <!-- Babel (for JSX) -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        @keyframes bounce {
            0%, 100% { transform: translateY(-25%); animation-timing-function: cubic-bezier(0.8,0,1,1); }
            50% { transform: none; animation-timing-function: cubic-bezier(0,0,0.2,1); }
        }
        .animate-bounce {
            animation: bounce 1s infinite;
        }
        .animate-pulse {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: .5; }
        }
        .item-pop {
            animation: pop 0.3s ease-out;
        }
        @keyframes pop {
            0% { transform: scale(0); }
            80% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }
    </style>
</head>
<body class="bg-slate-950 text-slate-100 min-h-screen flex items-center justify-center font-sans select-none">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useCallback } = React;

        // --- ì•„ì´ì½˜ ì»´í¬ë„ŒíŠ¸ ---
        const Heart = ({ className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"/></svg>
        );
        const Skull = ({ className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="9" cy="12" r="1"/><circle cx="15" cy="12" r="1"/><path d="M8 20v2h8v-2"/><path d="m12.5 17-.5-1-.5 1h1z"/><path d="M16 20a2 2 0 0 0 1.56-3.25 8 8 0 1 0-11.12 0A2 2 0 0 0 8 20"/></svg>
        );
        const Key = ({ className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="7.5" cy="15.5" r="5.5"/><path d="m21 2-9.6 9.6"/><path d="m15.5 7.5 3 3L22 7l-3-3"/></svg>
        );
        const DoorOpen = ({ className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M13 4h3a2 2 0 0 1 2 2v14"/><path d="M2 20h3"/><path d="M13 20h9"/><path d="M10 12v.01"/><path d="M13 4.562v16.157a1 1 0 0 1-1.242.97L5 20V5.562a2 2 0 0 1 1.515-1.94l4-1A2 2 0 0 1 13 4.561Z"/></svg>
        );
        const RefreshCw = ({ className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/><path d="M21 3v5h-5"/><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/><path d="M8 16H3v5"/></svg>
        );
        const Trophy = ({ className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"/><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"/><path d="M4 22h16"/><path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"/><path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"/><path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"/></svg>
        );
        const Coins = ({ className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="8" cy="8" r="6"/><path d="M18.09 10.37A6 6 0 1 1 10.34 18"/><path d="M7 6h1v4"/><path d="m7.1 13.8 3.1-9.1"/><path d="M10.8 17.7l-3.1-9.1"/></svg>
        );
        const Telescope = ({ className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12" cy="12" r="10"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/><path d="M2 12h20"/></svg>
        );
        const ShoppingCart = ({ className }) => (
             <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="8" cy="21" r="1"/><circle cx="19" cy="21" r="1"/><path d="M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12"/></svg>
        );

        // --- ê²Œì„ ìƒìˆ˜ ---
        const GRID_SIZE = 10;
        const INITIAL_HP = 3;
        const TRAP_COUNT = 15;
        const GOLD_COUNT = 5;
        const POTION_COUNT = 2; // ìƒì ì—ì„œ ì‚´ ìˆ˜ ìˆìœ¼ë¯€ë¡œ ê¸°ë³¸ ë“œë ì•½ê°„ ê°ì†Œ
        
        // ìƒì  ê°€ê²©
        const PRICE_POTION = 40;
        const PRICE_TELESCOPE = 20;

        const DungeonSweeper = () => {
            const [grid, setGrid] = useState([]);
            const [playerPos, setPlayerPos] = useState({ x: 0, y: 0 });
            const [hp, setHp] = useState(INITIAL_HP);
            const [gold, setGold] = useState(0);
            const [hasKey, setHasKey] = useState(false);
            const [gameStatus, setGameStatus] = useState('playing'); 
            const [message, setMessage] = useState("ë˜ì „ì— ì˜¤ì‹  ê²ƒì„ í™˜ì˜í•©ë‹ˆë‹¤!");
            const [floor, setFloor] = useState(1);
            
            // ìŠ¤í‚¬ ëª¨ë“œ: 'move'(ê¸°ë³¸), 'telescope'(ì›ê²© í™•ì¸)
            const [actionMode, setActionMode] = useState('move'); 

            const directions = [
                [-1, -1], [-1, 0], [-1, 1],
                [0, -1],           [0, 1],
                [1, -1],  [1, 0],  [1, 1]
            ];

            const initGame = useCallback((level = 1, carryOverHp, carryOverGold) => {
                const newGrid = [];
                const traps = [];
                
                // 1. ê·¸ë¦¬ë“œ ìƒì„±
                for (let y = 0; y < GRID_SIZE; y++) {
                    const row = [];
                    for (let x = 0; x < GRID_SIZE; x++) {
                        row.push({
                            x, y,
                            type: 'empty',
                            state: 'hidden',
                            adjacentDanger: 0,
                            id: `${x}-${y}`
                        });
                    }
                    newGrid.push(row);
                }

                // 2. ì‹œì‘ì  ì„¤ì • (0,0)
                newGrid[0][0].type = 'start';
                newGrid[0][0].state = 'revealed';
                const safeZone = [`0,0`, `0,1`, `1,0`, `1,1`];

                // 3. ì•„ì´í…œ ë°°ì¹˜
                const placeItem = (type, count) => {
                    let placed = 0;
                    while (placed < count) {
                        const rx = Math.floor(Math.random() * GRID_SIZE);
                        const ry = Math.floor(Math.random() * GRID_SIZE);
                        const key = `${rx},${ry}`;
                        
                        if (!safeZone.includes(key) && newGrid[ry][rx].type === 'empty') {
                            newGrid[ry][rx].type = type;
                            if (type === 'trap') traps.push({x: rx, y: ry});
                            placed++;
                        }
                    }
                };

                const currentTrapCount = TRAP_COUNT + Math.min((level - 1) * 2, 10); // ìµœëŒ€ì¹˜ ì œí•œ

                placeItem('door', 1);
                placeItem('key', 1);
                placeItem('trap', currentTrapCount);
                placeItem('potion', POTION_COUNT);
                placeItem('gold', GOLD_COUNT);

                // 4. ìœ„í—˜ë„ ê³„ì‚°
                for (let y = 0; y < GRID_SIZE; y++) {
                    for (let x = 0; x < GRID_SIZE; x++) {
                        if (newGrid[y][x].type === 'trap') continue;

                        let danger = 0;
                        directions.forEach(([dx, dy]) => {
                            const nx = x + dx;
                            const ny = y + dy;
                            if (nx >= 0 && nx < GRID_SIZE && ny >= 0 && ny < GRID_SIZE) {
                                if (newGrid[ny][nx].type === 'trap') danger++;
                            }
                        });
                        newGrid[y][x].adjacentDanger = danger;
                    }
                }

                setGrid(newGrid);
                setPlayerPos({ x: 0, y: 0 });
                setHasKey(false);
                setGameStatus('playing');
                setActionMode('move');

                if (level === 1) {
                    setHp(INITIAL_HP);
                    setGold(0);
                    setFloor(1);
                    setMessage("ìƒˆë¡œìš´ ëª¨í—˜ì´ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤.");
                } else {
                    setHp(carryOverHp);
                    setGold(carryOverGold);
                    setFloor(level);
                    setMessage(`${level}ì¸µì— ë„ë‹¬í–ˆìŠµë‹ˆë‹¤. í•¨ì •ì´ ë” ë§ì•„ì§‘ë‹ˆë‹¤!`);
                }
            }, []);

            useEffect(() => {
                initGame(1);
            }, [initGame]);

            // í™ìˆ˜ ì•Œê³ ë¦¬ì¦˜
            const revealEmptyArea = (startGrid, x, y) => {
                const queue = [{x, y}];
                const visited = new Set();
                const newGrid = [...startGrid];

                while (queue.length > 0) {
                    const {x: cx, y: cy} = queue.shift();
                    const key = `${cx},${cy}`;
                    if (visited.has(key)) continue;
                    visited.add(key);

                    if (cx < 0 || cx >= GRID_SIZE || cy < 0 || cy >= GRID_SIZE) continue;
                    
                    const cell = newGrid[cy][cx];
                    if (cell.state === 'revealed' && !(cx === x && cy === y)) continue;

                    cell.state = 'revealed';

                    if (cell.type === 'empty' && cell.adjacentDanger === 0) {
                        directions.forEach(([dx, dy]) => {
                            queue.push({x: cx + dx, y: cy + dy});
                        });
                    }
                }
                return newGrid;
            };

            const checkItemPickup = (cell, currentHp, currentGold, currentKey) => {
                let msg = "";
                let newHp = currentHp;
                let newGold = currentGold;
                let newKey = currentKey;
                let itemType = cell.type;

                if (itemType === 'key') {
                    newKey = true;
                    msg = "ğŸ”‘ ì—´ì‡  íšë“! íƒˆì¶œêµ¬ë¥¼ ì°¾ìœ¼ì„¸ìš”.";
                    cell.type = 'empty';
                } else if (itemType === 'potion') {
                    newHp = Math.min(currentHp + 1, INITIAL_HP + 3);
                    msg = "â¤ï¸ í¬ì…˜ ì‚¬ìš©! ì²´ë ¥ íšŒë³µ.";
                    cell.type = 'empty';
                } else if (itemType === 'gold') {
                    const gain = 10 + Math.floor(Math.random() * 6); // 10~15ê³¨ë“œ
                    newGold += gain;
                    msg = `ğŸ’° ${gain} ê³¨ë“œ íšë“!`;
                    cell.type = 'empty';
                }

                return { newHp, newGold, newKey, msg };
            };

            const handleInteraction = (x, y) => {
                if (gameStatus !== 'playing') return;

                const targetCell = grid[y][x];

                // --- ğŸ”­ ë§ì›ê²½ ëª¨ë“œ (ì›ê²© ì •ì°°) ---
                if (actionMode === 'telescope') {
                    if (targetCell.state === 'revealed') {
                        setMessage("ì´ë¯¸ ë°í˜€ì§„ ê³³ì…ë‹ˆë‹¤.");
                        setActionMode('move');
                        return;
                    }
                    
                    // ê³¨ë“œ ì†Œëª¨ í™•ì¸
                    if (gold < PRICE_TELESCOPE) {
                        setMessage("ê³¨ë“œê°€ ë¶€ì¡±í•©ë‹ˆë‹¤! (í•„ìš”: 20G)");
                        setActionMode('move');
                        return;
                    }

                    // ì •ì°° ì‹¤í–‰
                    setGold(g => g - PRICE_TELESCOPE);
                    
                    let newGrid = [...grid];
                    // ì •ì°°ì€ í•¨ì •ì„ ë°Ÿì§€ ì•Šê³  ë‚´ìš©ë§Œ ê³µê°œí•¨
                    targetCell.state = 'revealed';
                    
                    let msg = "";
                    if (targetCell.type === 'trap') {
                        msg = "âš ï¸ í•¨ì •ì„ ë°œê²¬í–ˆìŠµë‹ˆë‹¤! ë°Ÿì§€ ì•Šì•„ì„œ ë‹¤í–‰ì…ë‹ˆë‹¤.";
                    } else {
                         // ì•ˆì „ì§€ëŒ€ë©´ ì£¼ë³€ë„ ì—´ë¦´ ìˆ˜ ìˆìŒ (ì„ íƒì‚¬í•­ì´ë‚˜ ì—¬ê¸°ì„  ê·¸ëƒ¥ ë‹¨ì¼ ì˜¤í”ˆ)
                         if (targetCell.adjacentDanger === 0 && targetCell.type === 'empty') {
                             newGrid = revealEmptyArea(newGrid, x, y);
                         }
                         msg = "ì•ˆì „í•œ ì§€ì—­ì„ í™•ì¸í–ˆìŠµë‹ˆë‹¤.";
                    }
                    
                    // ì•„ì´í…œì´ ìˆë‹¤ë©´ íšë“ì€ í•˜ì§€ ì•Šê³  ë³´ì—¬ì£¼ê¸°ë§Œ í•¨ (ì§ì ‘ ê°€ì•¼ íšë“)
                    if (['potion','gold','key'].includes(targetCell.type)) {
                         msg = "ì•„ì´í…œì„ ë°œê²¬í–ˆìŠµë‹ˆë‹¤! ì§ì ‘ ê°€ì„œ íšë“í•˜ì„¸ìš”.";
                    }

                    setGrid(newGrid);
                    setMessage(msg);
                    setActionMode('move'); // ë‹¤ì‹œ ì´ë™ ëª¨ë“œë¡œ ë³µê·€
                    return;
                }

                // --- ğŸ¦¶ ì´ë™ ëª¨ë“œ (ê¸°ë³¸) ---
                const isAdjacent = Math.abs(playerPos.x - x) <= 1 && Math.abs(playerPos.y - y) <= 1;
                const isRevealed = targetCell.state === 'revealed';

                // ë¯¸íƒí—˜ ì§€ì—­ì€ ì¸ì ‘í•œ ê³³ë§Œ, ë°í˜€ì§„ ê³³ì€ ì–´ë””ë“  ì´ë™
                if (!isAdjacent && !isRevealed) {
                    setMessage("ë¯¸íƒí—˜ ì§€ì—­ì€ ì¸ì ‘í•œ ì¹¸ìœ¼ë¡œë§Œ ê°ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.");
                    return;
                }

                let newGrid = [...grid];
                let currentHp = hp;
                let currentGold = gold;
                let currentKey = hasKey;
                let currentMsg = "";

                // 1. ì´ë¯¸ ê³µê°œëœ ê³³ìœ¼ë¡œ ì´ë™ (ë¹ ë¥¸ ì´ë™)
                if (targetCell.state === 'revealed') {
                    const pickup = checkItemPickup(targetCell, currentHp, currentGold, currentKey);
                    currentHp = pickup.newHp;
                    currentGold = pickup.newGold;
                    currentKey = pickup.newKey;
                    if(pickup.msg) currentMsg = pickup.msg;

                    if (targetCell.type === 'door') {
                        if (currentKey) {
                            initGame(floor + 1, currentHp, currentGold); // ë‹¤ìŒ ì¸µìœ¼ë¡œ ìƒíƒœ ê³„ìŠ¹
                            return;
                        } else {
                            currentMsg = "ë¬¸ì´ ì ê²¨ìˆìŠµë‹ˆë‹¤. ì—´ì‡ ê°€ í•„ìš”í•©ë‹ˆë‹¤!";
                        }
                    } 
                    
                    setHp(currentHp);
                    setGold(currentGold);
                    setHasKey(currentKey);
                    setPlayerPos({ x, y });
                    if(currentMsg) setMessage(currentMsg);
                } 
                // 2. ë¯¸íƒí—˜ ì§€ì—­ìœ¼ë¡œ ì´ë™ (ìœ„í—˜)
                else {
                    if (targetCell.type === 'trap') {
                        currentHp -= 1;
                        setHp(currentHp);
                        targetCell.state = 'revealed';
                        currentMsg = "ğŸ”¥ ìœ¼ì•…! í•¨ì •ì„ ë°Ÿì•˜ìŠµë‹ˆë‹¤! (HP -1)";
                        
                        if (currentHp <= 0) {
                            setGameStatus('lost');
                            setMessage("ì“°ëŸ¬ì¡ŒìŠµë‹ˆë‹¤... ì—¬ì •ì´ ëë‚¬ìŠµë‹ˆë‹¤.");
                            return;
                        }
                    } else {
                        // ì•ˆì „í•˜ê²Œ ë„ì°© -> ì•„ì´í…œ íšë“ ì²´í¬
                        const pickup = checkItemPickup(targetCell, currentHp, currentGold, currentKey);
                        currentHp = pickup.newHp;
                        currentGold = pickup.newGold;
                        currentKey = pickup.newKey;
                        if(pickup.msg) currentMsg = pickup.msg;

                        if (targetCell.type === 'door') {
                            currentMsg = "ì¶œêµ¬ ë°œê²¬! ì—´ì‡ ê°€ í•„ìš”í•©ë‹ˆë‹¤.";
                        }

                        // ë¹ˆ ë•…ì´ë©´ ì£¼ë³€ ì—´ê¸°
                        if (targetCell.adjacentDanger === 0 && targetCell.type === 'empty') {
                            newGrid = revealEmptyArea(newGrid, x, y);
                        } else {
                            targetCell.state = 'revealed';
                        }
                    }

                    setGrid(newGrid);
                    setHp(currentHp);
                    setGold(currentGold);
                    setHasKey(currentKey);
                    setPlayerPos({ x, y });
                    if (currentMsg) setMessage(currentMsg);
                }
            };

            const buyPotion = () => {
                if (gold >= PRICE_POTION) {
                    if (hp >= INITIAL_HP + 3) {
                        setMessage("ì²´ë ¥ì´ ì´ë¯¸ ê°€ë“ ì°¼ìŠµë‹ˆë‹¤.");
                        return;
                    }
                    setGold(g => g - PRICE_POTION);
                    setHp(h => h + 1);
                    setMessage("â¤ï¸ ìƒì ì—ì„œ í¬ì…˜ì„ êµ¬ë§¤í–ˆìŠµë‹ˆë‹¤.");
                } else {
                    setMessage(`ê³¨ë“œê°€ ë¶€ì¡±í•©ë‹ˆë‹¤. (${PRICE_POTION}G í•„ìš”)`);
                }
            };

            const toggleTelescope = () => {
                if (actionMode === 'telescope') {
                    setActionMode('move');
                    setMessage("ì´ë™ ëª¨ë“œë¡œ ì „í™˜í•©ë‹ˆë‹¤.");
                } else {
                    if (gold >= PRICE_TELESCOPE) {
                        setActionMode('telescope');
                        setMessage("ğŸ”­ ì •ì°°í•  ìœ„ì¹˜ë¥¼ í´ë¦­í•˜ì„¸ìš”. (ë¹„ìš©: 20G)");
                    } else {
                        setMessage(`ê³¨ë“œê°€ ë¶€ì¡±í•©ë‹ˆë‹¤. (${PRICE_TELESCOPE}G í•„ìš”)`);
                    }
                }
            };

            const getCellContent = (cell) => {
                const isPlayerHere = playerPos.x === cell.x && playerPos.y === cell.y;
                
                // íˆë“  ìƒíƒœ
                if (cell.state === 'hidden') {
                     if (isPlayerHere) {
                         return (
                            <div className="w-full h-full flex items-center justify-center bg-slate-700 border border-slate-600 rounded-sm relative">
                                <div className="text-2xl animate-bounce z-10">ğŸ¤ </div>
                            </div>
                         );
                     }
                     // ë§ì›ê²½ ëª¨ë“œì¼ ë•Œ ì»¤ì„œ ë³€ê²½ íš¨ê³¼
                     const cursorClass = actionMode === 'telescope' ? 'cursor-crosshair hover:bg-slate-500' : 'cursor-pointer hover:bg-slate-600';
                     return <div className={`w-full h-full bg-slate-700 rounded-sm border border-slate-600 transition-colors ${cursorClass}`} />;
                }

                // ê³µê°œëœ ìƒíƒœ
                let content = null;
                if (cell.type === 'trap') content = <Skull className="text-red-500 w-6 h-6 item-pop" />;
                else if (cell.type === 'potion') content = <Heart className="text-pink-500 fill-pink-500 w-5 h-5 item-pop" />;
                else if (cell.type === 'gold') content = <Coins className="text-yellow-400 w-5 h-5 item-pop" />;
                else if (cell.type === 'key') content = <Key className="text-yellow-500 w-6 h-6 rotate-45 item-pop" />;
                else if (cell.type === 'door') content = <DoorOpen className={`w-6 h-6 ${hasKey ? 'text-green-400' : 'text-slate-400'} item-pop`} />;
                else if (cell.type === 'start') content = <span className="text-xs text-slate-400">START</span>;
                else if (cell.adjacentDanger > 0) {
                    const colors = ['text-blue-400', 'text-green-400', 'text-red-400', 'text-purple-400', 'text-orange-400'];
                    content = <span className={`font-bold text-xl ${colors[cell.adjacentDanger-1] || 'text-red-600'}`}>{cell.adjacentDanger}</span>;
                }

                return (
                    <div className={`w-full h-full flex items-center justify-center border border-slate-800 rounded-sm relative 
                        ${cell.type === 'trap' ? 'bg-red-900/30' : 'bg-slate-900'}`}>
                        {content}
                        
                        {isPlayerHere && (
                            <div className="absolute inset-0 flex items-center justify-center pointer-events-none">
                                <div className={`text-2xl animate-bounce transition-opacity duration-300 ${content ? 'opacity-60' : 'opacity-100'}`} 
                                     style={{ textShadow: '0 0 10px rgba(0,0,0,0.5)' }}>
                                    ğŸ¤ 
                                </div>
                            </div>
                        )}
                    </div>
                );
            };

            return (
                <div className="max-w-md w-full bg-slate-900 p-6 rounded-xl shadow-2xl border border-slate-800">
                    
                    {/* ìƒë‹¨ ì •ë³´ì°½ */}
                    <div className="flex justify-between items-center mb-4 bg-slate-800 p-3 rounded-lg">
                        <div className="flex items-center gap-4">
                            <div className="flex items-center gap-1 text-pink-400" title="ì²´ë ¥">
                                <Heart className="fill-pink-400 w-5 h-5" />
                                <span className="font-bold text-lg">{hp}</span>
                            </div>
                            <div className="flex items-center gap-1 text-yellow-400" title="ê³¨ë“œ">
                                <Coins className="w-5 h-5 fill-yellow-400/20" />
                                <span className="font-bold text-lg">{gold}</span>
                            </div>
                        </div>
                        <div className="flex items-center gap-3">
                            <div className="flex items-center gap-1 text-purple-300 bg-purple-900/30 px-2 py-1 rounded">
                                <Trophy className="w-4 h-4" />
                                <span className="font-bold text-sm">{floor}F</span>
                            </div>
                            {hasKey && (
                                <div className="text-yellow-400 animate-pulse">
                                    <Key className="w-5 h-5" />
                                </div>
                            )}
                        </div>
                    </div>

                    {/* ë©”ì‹œì§€ ë°•ìŠ¤ */}
                    <div className={`mb-4 text-center h-6 text-sm font-medium transition-colors ${actionMode === 'telescope' ? 'text-green-400' : 'text-cyan-300'}`}>
                        {message}
                    </div>

                    {/* ê²Œì„ ê·¸ë¦¬ë“œ */}
                    <div 
                        className={`grid gap-1 mb-6 mx-auto bg-slate-800 p-2 rounded-lg relative transition-all duration-300 
                        ${actionMode === 'telescope' ? 'ring-2 ring-green-500/50 shadow-[0_0_20px_rgba(34,197,94,0.2)]' : ''}`}
                        style={{ 
                            gridTemplateColumns: `repeat(${GRID_SIZE}, minmax(0, 1fr))`,
                            width: 'fit-content'
                        }}
                    >
                        {grid.map((row, y) => (
                            row.map((cell, x) => (
                                <div 
                                    key={cell.id}
                                    onClick={() => handleInteraction(x, y)}
                                    className="w-8 h-8 sm:w-9 sm:h-9 relative"
                                >
                                    {getCellContent(cell)}
                                </div>
                            ))
                        ))}
                        
                        {gameStatus === 'lost' && (
                            <div className="absolute inset-0 bg-black/85 flex flex-col items-center justify-center rounded-lg z-20 backdrop-blur-sm">
                                <Skull className="w-16 h-16 text-red-500 mb-2 animate-bounce" />
                                <h2 className="text-2xl font-bold text-white mb-2">GAME OVER</h2>
                                <p className="text-slate-400 mb-6 text-sm">{floor}ì¸µì—ì„œ ì—¬ì •ì„ ë§ˆì³¤ìŠµë‹ˆë‹¤.</p>
                                <button 
                                    onClick={() => initGame(1)}
                                    className="flex items-center gap-2 bg-red-600 hover:bg-red-700 text-white px-6 py-2 rounded-full font-bold transition-transform hover:scale-105"
                                >
                                    <RefreshCw className="w-4 h-4" /> ë‹¤ì‹œ ì‹œì‘
                                </button>
                            </div>
                        )}
                    </div>

                    {/* í•˜ë‹¨: ìƒì  ë° ì•¡ì…˜ ë°” */}
                    <div className="grid grid-cols-2 gap-3">
                        <button 
                            onClick={buyPotion}
                            className="flex flex-col items-center justify-center bg-slate-800 hover:bg-slate-700 active:bg-slate-600 p-3 rounded-lg border border-slate-700 transition-colors group"
                        >
                            <div className="flex items-center gap-2 text-pink-400 mb-1">
                                <Heart className="w-5 h-5 fill-pink-400" />
                                <span className="font-bold">íšŒë³µ</span>
                            </div>
                            <span className="text-xs text-yellow-500 group-hover:text-yellow-400">{PRICE_POTION} G</span>
                        </button>

                        <button 
                            onClick={toggleTelescope}
                            className={`flex flex-col items-center justify-center p-3 rounded-lg border transition-colors group
                                ${actionMode === 'telescope' 
                                    ? 'bg-green-900/40 border-green-500 text-green-300' 
                                    : 'bg-slate-800 border-slate-700 hover:bg-slate-700 text-slate-300'}`}
                        >
                            <div className="flex items-center gap-2 mb-1">
                                <Telescope className="w-5 h-5" />
                                <span className="font-bold">ì •ì°°</span>
                            </div>
                            <span className="text-xs text-yellow-500 group-hover:text-yellow-400">{PRICE_TELESCOPE} G</span>
                        </button>
                    </div>
                    
                    <div className="mt-3 text-[10px] text-slate-500 text-center flex justify-center gap-4">
                        <span>â¤ï¸ í¬ì…˜: ì²´ë ¥ +1</span>
                        <span>ğŸ”­ ì •ì°°: ì›ê±°ë¦¬ í™•ì¸</span>
                    </div>

                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<DungeonSweeper />);
    </script>
</body>
</html>
